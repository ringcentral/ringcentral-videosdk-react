var We=Object.defineProperty;var a=(e,t)=>We(e,"name",{value:t,configurable:!0});import{r as h,j as n,a as ke,b as v,F as E}from"./jsx-runtime.e25c9067.js";import{j as se,k as le,s as ce,l as de,_ as S,u as ue,m as pe,n as Pe,o as Oe,p as ge,q as me,r as Ge,t as ze,v as Je,F as he,w as Fe,I as ye,x as fe,y as De,z as je,O as Ve,B as $e,U as He,D as qe,E as Ue,H as Be,J as x,K as ve,N as R,Q as j,T as ee,W as Ke,X as Qe,G as Ye,i as Xe,A as Ze,a as et,V as tt,S as nt,P as te,C as ne,R as ie,c as it,L as rt,M as ot,b as at}from"./index.7086465b.js";import"./iframe.3d1fb436.js";import"./index.d289d216.js";import"./index.fa17637c.js";import"./en.696be457.js";function st(e){return le("MuiFormHelperText",e)}a(st,"getFormHelperTextUtilityClasses");const lt=se("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),re=lt;var oe;const ct=["children","className","component","disabled","error","filled","focused","margin","required","variant"],dt=a(e=>{const{classes:t,contained:i,size:s,disabled:d,error:g,filled:o,focused:l,required:m}=e,u={root:["root",d&&"disabled",g&&"error",s&&`size${de(s)}`,i&&"contained",l&&"focused",o&&"filled",m&&"required"]};return me(u,st,t)},"useUtilityClasses$1"),ut=ce("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.size&&t[`size${de(i.size)}`],i.contained&&t.contained,i.filled&&t.filled]}})(({theme:e,ownerState:t})=>S({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${re.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${re.error}`]:{color:(e.vars||e).palette.error.main}},t.size==="small"&&{marginTop:4},t.contained&&{marginLeft:14,marginRight:14})),pt=h.exports.forwardRef(a(function(t,i){const s=ue({props:t,name:"MuiFormHelperText"}),{children:d,className:g,component:o="p"}=s,l=pe(s,ct),m=Pe(),u=Oe({props:s,muiFormControl:m,states:["variant","size","disabled","error","filled","focused","required"]}),r=S({},s,{component:o,contained:u.variant==="filled"||u.variant==="outlined",variant:u.variant,size:u.size,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),b=dt(r);return n(ut,S({as:o,ownerState:r,className:ge(b.root,g),ref:i},l,{children:d===" "?oe||(oe=n("span",{className:"notranslate",children:"\u200B"})):d}))},"FormHelperText")),gt=pt;function mt(e,t,i,s,d){const[g,o]=h.exports.useState(()=>d&&i?i(e).matches:s?s(e).matches:t);return Je(()=>{let l=!0;if(!i)return;const m=i(e),u=a(()=>{l&&o(m.matches)},"updateMatch");return u(),m.addListener(u),()=>{l=!1,m.removeListener(u)}},[e,i]),g}a(mt,"useMediaQueryOld");const xe=ke["useSyncExternalStore"];function ht(e,t,i,s,d){const g=h.exports.useCallback(()=>t,[t]),o=h.exports.useMemo(()=>{if(d&&i)return()=>i(e).matches;if(s!==null){const{matches:r}=s(e);return()=>r}return g},[g,e,s,d,i]),[l,m]=h.exports.useMemo(()=>{if(i===null)return[g,()=>()=>{}];const r=i(e);return[()=>r.matches,b=>(r.addListener(b),()=>{r.removeListener(b)})]},[g,i,e]);return xe(m,l,o)}a(ht,"useMediaQueryNew");function yt(e,t={}){const i=Ge(),s=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:d=!1,matchMedia:g=s?window.matchMedia:null,ssrMatchMedia:o=null,noSsr:l=!1}=ze({name:"MuiUseMediaQuery",props:t,theme:i});let m=typeof e=="function"?e(i):e;return m=m.replace(/^@media( ?)/m,""),(xe!==void 0?ht:mt)(m,d,g,o,l)}a(yt,"useMediaQuery");function ft(e){return le("MuiTextField",e)}a(ft,"getTextFieldUtilityClass");se("MuiTextField",["root"]);const vt=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],xt={standard:De,filled:je,outlined:Ve},wt=a(e=>{const{classes:t}=e;return me({root:["root"]},ft,t)},"useUtilityClasses"),bt=ce(he,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),St=h.exports.forwardRef(a(function(t,i){const s=ue({props:t,name:"MuiTextField"}),{autoComplete:d,autoFocus:g=!1,children:o,className:l,color:m="primary",defaultValue:u,disabled:r=!1,error:b=!1,FormHelperTextProps:k,fullWidth:T=!1,helperText:M,id:C,InputLabelProps:p,inputProps:y,InputProps:z,inputRef:L,label:_,maxRows:be,minRows:Se,multiline:B=!1,name:Ie,onBlur:Te,onChange:Me,onFocus:Ee,placeholder:Re,required:K=!1,rows:Ce,select:J=!1,SelectProps:F,type:Le,value:Q,variant:P="outlined"}=s,_e=pe(s,vt),Y=S({},s,{autoFocus:g,color:m,disabled:r,error:b,fullWidth:T,multiline:B,required:K,select:J,variant:P}),Ae=wt(Y),A={};P==="outlined"&&(p&&typeof p.shrink<"u"&&(A.notched=p.shrink),A.label=_),J&&((!F||!F.native)&&(A.id=void 0),A["aria-describedby"]=void 0);const I=Fe(C),D=M&&I?`${I}-helper-text`:void 0,X=_&&I?`${I}-label`:void 0,Ne=xt[P],Z=n(Ne,S({"aria-describedby":D,autoComplete:d,autoFocus:g,defaultValue:u,fullWidth:T,multiline:B,name:Ie,rows:Ce,maxRows:be,minRows:Se,type:Le,value:Q,id:I,inputRef:L,onBlur:Te,onChange:Me,onFocus:Ee,placeholder:Re,inputProps:y},A,z));return v(bt,S({className:ge(Ae.root,l),disabled:r,error:b,fullWidth:T,ref:i,required:K,color:m,variant:P,ownerState:Y},_e,{children:[_!=null&&_!==""&&n(ye,S({htmlFor:I,id:X},p,{children:_})),J?n(fe,S({"aria-describedby":D,id:I,labelId:X,value:Q,input:Z},F,{children:o})):Z,M&&n(gt,S({id:D},k,{children:M}))]}))},"TextField")),w=St,It=a(({rcvEngine:e,localeConfig:t,waitingRoomContent:i,children:s})=>n($e.Provider,{value:{rcvEngine:e,localeConfig:t,waitingRoomContent:i},children:n(He,{children:n(qe,{children:n(Ue,{children:n(Be,{children:s})})})})}),"RcvEngineProvider"),W=a(e=>e?localStorage:sessionStorage,"getStorage"),V="AUTH_KEY",we="KEY_AUTH_FORM",N="MEETING_ID";function G(e,t,i=!0){if(typeof localStorage!="object"||typeof sessionStorage!="object")return t;let s;return typeof i>"u"?s=W(!0).getItem(e)||W(!1).getItem(e):s=W(i).getItem(e),s?JSON.parse(s):t}a(G,"readLocallyStored");const O=a((e,t=null,i=!0)=>{W(i).setItem(e,JSON.stringify(t))},"writeLocallyStored"),ae=a((e,t=!0)=>{W(t).setItem(e,"")},"removeLocallyStored"),c={clientId:"",clientSecret:"",jwt:"",username:"",password:""};var f=(e=>(e.PASSWORD="PASSWORD",e.TOKEN="TOKEN",e.JWT="JWT",e))(f||{});function Tt(){const e=G(we,void 0,!0);return{authType:(e==null?void 0:e.authType)||"JWT",clientId:(e==null?void 0:e.clientId)||(c==null?void 0:c.clientId)||"",clientSecret:(e==null?void 0:e.clientSecret)||(c==null?void 0:c.clientSecret)||"",token:(e==null?void 0:e.token)||(c==null?void 0:c.token),username:(e==null?void 0:e.username)||(c==null?void 0:c.username),password:(e==null?void 0:e.password)||(c==null?void 0:c.password),jwt:(e==null?void 0:e.jwt)||(c==null?void 0:c.jwt),external:(e==null?void 0:e.external)||(c==null?void 0:c.external),grantType:(e==null?void 0:e.grantType)||(c==null?void 0:c.grantType)}}a(Tt,"getDefaultAuthFormData");async function Mt(e){var i;(i=x.exports.RcvEngine.instance())==null||i.destroy();const t=x.exports.RcvEngine.create({enableDiscovery:!1,origin:c.origin||"https://platform.ringcentral.com",...e,external:{...e.external,...c.dev}});return e.authType===f.TOKEN?await t.setAuthToken(JSON.stringify(e.token)):e.authType===f.JWT?await t.authorize({grantType:x.exports.GrantType.JWT,jwt:e.jwt}):await t.authorize({grantType:x.exports.GrantType.PASSWORD,username:e.username,password:e.password}),console.debug("createRcvEngine called and got: ",t),t}a(Mt,"createRcvEngine");function $({onClear:e,rcvEngine:t,onStartMeeting:i,onJoinMeeting:s}){const[d,g]=h.exports.useState(G(N,void 0,!0));return n(E,{children:v(ve,{elevation:1,style:{padding:16,display:"flex"},children:[n(w,{className:"item",label:"Meeting Id",size:"small",style:{width:300,marginRight:4},value:d,variant:"outlined",onChange:o=>g(o.target.value)}),n(R,{style:{marginRight:4},variant:"contained",onClick:()=>{s(t,d)},children:"Join"}),n(R,{style:{marginRight:4},variant:"outlined",onClick:()=>{i(t)},children:"Start a Meeting"}),n(R,{style:{marginRight:4},variant:"text",onClick:e,children:"Reset"})]})})}a($,"StartMeeting");try{$.displayName="StartMeeting",$.__docgenInfo={description:"",displayName:"StartMeeting",props:{rcvEngine:{defaultValue:null,description:"",name:"rcvEngine",required:!0,type:{name:"RcvEngine"}},onClear:{defaultValue:null,description:"",name:"onClear",required:!0,type:{name:"() => void"}},onJoinMeeting:{defaultValue:null,description:"",name:"onJoinMeeting",required:!0,type:{name:"(rcvEngine: RcvEngine, meetingId?: string | undefined) => void"}},onStartMeeting:{defaultValue:null,description:"",name:"onStartMeeting",required:!0,type:{name:"(rcvEngine: RcvEngine) => void"}}}}}catch{}function H({onSubmit:e}){const t=Tt(),[i,s]=h.exports.useState(JSON.stringify(t.token)),[d,g]=h.exports.useState(JSON.stringify(t.external)),[o,l]=h.exports.useState(t),m=a(()=>{const r={...o};o.authType===f.TOKEN&&i&&(r.token=JSON.parse(i)),d&&(r.external=JSON.parse(d)||{}),o.authType===f.PASSWORD&&(r.grantType="PASSWORD"),O(we,r),e(r)},"handleSubmit"),u=a(()=>{switch(o.authType){case f.TOKEN:return v(E,{children:[n(w,{fullWidth:!0,label:"clientId",placeholder:"your clientID",size:"small",type:"text",value:o.clientId,variant:"outlined",onChange:r=>l({...o,clientId:r.target.value})}),n("div",{className:"br"}),n(w,{fullWidth:!0,label:"clientSecret",placeholder:"your client secret",size:"small",type:"text",value:o.clientSecret,variant:"outlined",onChange:r=>l({...o,clientSecret:r.target.value})}),n("div",{className:"br"}),n("h3",{children:"Token"}),n(ee,{maxRows:20,minRows:8,placeholder:"your token",style:{width:"100%"},value:i,onChange:r=>s(r.target.value)})]});case f.JWT:return v(E,{children:[n(w,{fullWidth:!0,label:"clientId",placeholder:"your clientID",size:"small",type:"text",value:o.clientId,variant:"outlined",onChange:r=>l({...o,clientId:r.target.value})}),n("div",{className:"br"}),n(w,{fullWidth:!0,label:"clientSecret",placeholder:"your client secret",size:"small",type:"text",value:o.clientSecret,variant:"outlined",onChange:r=>l({...o,clientSecret:r.target.value})}),n("div",{className:"br"}),n(w,{fullWidth:!0,label:"JWT",placeholder:"your jwt",size:"small",type:"text",value:o.jwt,variant:"outlined",onChange:r=>l({...o,jwt:r.target.value})})]});case f.PASSWORD:return v(E,{children:[n(w,{fullWidth:!0,label:"clientId",placeholder:"your clientID",size:"small",type:"text",value:o.clientId,variant:"outlined",onChange:r=>l({...o,clientId:r.target.value})}),n("div",{className:"br"}),n(w,{fullWidth:!0,label:"clientSecret",placeholder:"your client secret",size:"small",type:"text",value:o.clientSecret,variant:"outlined",onChange:r=>l({...o,clientSecret:r.target.value})}),n("div",{className:"br"}),n(w,{fullWidth:!0,label:"username",placeholder:"your username",size:"small",type:"text",value:o.username,variant:"outlined",onChange:r=>l({...o,username:r.target.value})}),n("div",{className:"br"}),n(w,{fullWidth:!0,label:"password",placeholder:"your password",size:"small",type:"text",value:o.password,variant:"outlined",onChange:r=>l({...o,password:r.target.value})})]});default:return[]}},"renderAuthForm");return v(E,{children:[v(he,{children:[n(ye,{children:"Auth Type"}),v(fe,{label:"Auth Type",size:"small",value:o.authType,onChange:r=>l({...o,authType:r.target.value}),children:[n(j,{value:f.JWT,children:f.JWT}),n(j,{value:f.PASSWORD,children:f.PASSWORD}),n(j,{value:f.TOKEN,children:f.TOKEN})]})]}),n("div",{className:"br"}),u(),n("h3",{children:"External config"}),n(ee,{maxRows:20,minRows:8,style:{width:"100%"},value:d,onChange:r=>g(r.target.value)}),n("div",{className:"br"}),n(R,{variant:"contained",onClick:m,children:"Init Config"})]})}a(H,"AuthForm");try{H.displayName="AuthForm",H.__docgenInfo={description:"",displayName:"AuthForm",props:{onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(authInfo: IAuth) => void"}}}}}catch{}function Et(){const e=window.rcv;return console.debug("get rcvEngine from window and got: ",e),e}a(Et,"getInitRcvFromWindow");function Rt(e){var t;try{const i=((t=e==null?void 0:e.getMeetingController())==null?void 0:t.getMeetingState())===x.exports.RcvMeetingState.MEETING_STATE_INMEETING;return console.debug("check isInMeeting: ",i),i}catch{return!1}}a(Rt,"checkIsInMeeting");function Ct(e){var t;try{const i=(t=e==null?void 0:e.getMeetingController())==null?void 0:t._bridge.pins.web;return console.debug("get meeting id from from rcvEngine and got",i),i}catch{return}}a(Ct,"getMeetingId");function q({onReset:e,children:t,rcvEngine:i,meetingId:s}){return v(E,{children:[v(ve,{elevation:1,style:{left:8,top:8,position:"absolute",zIndex:100,padding:8},children:[n("b",{children:s}),n(R,{variant:"text",onClick:e,children:"Reset"})]}),n(It,{localeConfig:{chat_dialog_title:"My chat"},rcvEngine:i,children:t})]})}a(q,"InMeeting");try{q.displayName="InMeeting",q.__docgenInfo={description:"",displayName:"InMeeting",props:{meetingId:{defaultValue:null,description:"",name:"meetingId",required:!0,type:{name:"string"}},rcvEngine:{defaultValue:null,description:"",name:"rcvEngine",required:!0,type:{name:"RcvEngine"}},onReset:{defaultValue:null,description:"",name:"onReset",required:!0,type:{name:"() => void"}}}}}catch{}function U({meetingId:e,onReset:t}){return v(Ke,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"200px"},children:[n(Qe,{}),v("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:8},children:[v("div",{style:{marginRight:8},children:["Joining meeting ",e?`: ${e}`:""]}),n(R,{variant:"text",onClick:t,children:"Reset"})]})]})}a(U,"MeetingLoading");try{U.displayName="MeetingLoading",U.__docgenInfo={description:"",displayName:"MeetingLoading",props:{meetingId:{defaultValue:null,description:"",name:"meetingId",required:!1,type:{name:"string | undefined"}},onReset:{defaultValue:null,description:"",name:"onReset",required:!0,type:{name:"() => void"}}}}}catch{}const Lt=a(({children:e})=>{const[t,i]=h.exports.useState(Et()),[s,d]=h.exports.useState(!1),[g,o]=h.exports.useState(Rt(t)),[l,m]=h.exports.useState(Ct(t)),[u,r]=h.exports.useState(window.auth);h.exports.useEffect(()=>{t&&(console.debug(`addEventListener ${x.exports.EngineEvent.MEETING_JOINED} to rcvEngine`),t.on(x.exports.EngineEvent.MEETING_JOINED,p=>{console.debug(`event ${x.exports.EngineEvent.MEETING_JOINED} triggered with data: ${p}`),m(p),o(!0),O(N,p)}),console.debug(`addEventListener ${x.exports.EngineEvent.MEETING_JOINED} to rcvEngine`),t.on(x.exports.EngineEvent.MEETING_LEFT,()=>{console.debug(`event ${x.exports.EngineEvent.MEETING_LEFT} triggered`),m(""),o(!1),O(N,"")}))},[t]),h.exports.useEffect(()=>{a(async()=>{if(window.rcv){console.debug("got rcvEngine from window, no need to rejoin a meeting");return}const y=G(V,void 0,!0);if(y){console.debug("got auth info from local storage, will init rcvEngine automatically"),await T(y);const z=await M(y),L=G(N,void 0,!0);L&&(console.debug(`got meetingId from local storage, will rejoin meeting ${L}`),await k(z,L))}},"rejoinMeeting")().then()},[]);const b=a(async p=>{d(!0),console.debug("start meeting"),await p.startInstantMeeting(),d(!1)},"handleStartMeeting"),k=a(async(p,y)=>{if(!y){alert("Meeting id can not be empty!");return}m(y),d(!0),console.debug(`join meeting with meetingId: ${y}`),await p.joinMeeting(y),d(!1)},"handleJoinMeeting"),T=a(async p=>(window.auth=p,r(p),O(V,p,!0),p),"handleSubmitAuth"),M=a(async p=>{const y=await Mt({...p});return window.rcv=y,i(y),y},"handleInitRcv"),C=a(()=>{ae(V),ae(N),t==null||t.destroy(),i(void 0),r(void 0),window.rcv=void 0,window.auth=void 0},"handleReset");if(s)return n(U,{meetingId:l,onReset:C});if(t){if(g&&l)return n(q,{meetingId:l,rcvEngine:t,onReset:C,children:e});if(!g)return n($,{rcvEngine:t,onClear:C,onJoinMeeting:k,onStartMeeting:b})}return u?n("p",{children:"loading..."}):n("div",{style:{padding:"1em"},children:n(H,{onSubmit:async p=>{await T(p),await M(p)}})})},"MeetingWrapper");function _t(){const e=yt("(min-width:850px)");return v("div",{style:{display:"flex",width:"100%",height:"100%",flexDirection:"column",border:"1px solid #eee",boxSizing:"border-box"},children:[n(Ye,{layout:Xe.gallery,style:{flex:1}}),n(Ze,{centerActions:[n(et,{isShowLabel:!0},"audio-action"),n(tt,{isShowLabel:!0},"video-action"),n(nt,{isShowLabel:!0},"screen-sharing-action"),e&&n(te,{isShowLabel:!0},"participant-action"),e&&n(ne,{isShowLabel:!0},"chat-action"),e&&n(ie,{isShowLabel:!0},"record-action"),n(it,{isShowLabel:!0,moreActions:[!e&&n(te,{isShowLabel:!0},"participant-action"),!e&&n(ne,{isShowLabel:!0},"chat-action"),!e&&n(ie,{isShowLabel:!0},"record-action")]},"chat-action"),n(rt,{isShowLabel:!0},"leave-action")],leftActions:[n(ot,{},"meeting-info-action")],rightActions:[n(at,{text:"RingCentral"},"logo-icon")]})]})}a(_t,"Meeting");const zt={parameters:{storySource:{source:`import React from 'react';
import { useMediaQuery } from '@mui/material';
import type { Story } from '@storybook/react';
import MeetingWrapper from './bootstrap/components/meeting-wrapper';
import {
    ActionBar,
    AudioAction,
    ChatAction,
    LeaveAction,
    LogoIcon, MeetingInfoAction,
    ParticipantAction,
    RecordAction,
    VideoAction,
    GalleryLayout,
    GalleryLayoutType,
    ScreenSharingAction,
    MoreAction,
} from '../lib';

function Meeting() {
    const isWidthGt850 = useMediaQuery('(min-width:850px)');
    return (
        <div
            style={{
                display: 'flex',
                width: '100%',
                height: '100%',
                flexDirection: 'column',
                border: '1px solid #eee',
                boxSizing: 'border-box',
            }}>
            <GalleryLayout
                layout={GalleryLayoutType.gallery}
                style={{
                    flex: 1,
                }}
            />
            <ActionBar
                centerActions={[
                    <AudioAction isShowLabel={true} key={'audio-action'} />,
                    <VideoAction isShowLabel={true} key={'video-action'} />,
                    <ScreenSharingAction isShowLabel={true} key={'screen-sharing-action'} />,
                    isWidthGt850 && <ParticipantAction isShowLabel={true} key={'participant-action'} />,
                    isWidthGt850 && <ChatAction isShowLabel={true} key={'chat-action'} />,
                    isWidthGt850 && <RecordAction isShowLabel={true} key={'record-action'} />,
                    <MoreAction
                        isShowLabel={true}
                        key={'chat-action'}
                        moreActions={[
                            !isWidthGt850 && <ParticipantAction isShowLabel={true} key={'participant-action'} />,
                            !isWidthGt850 && <ChatAction isShowLabel={true} key={'chat-action'} />,
                            !isWidthGt850 && <RecordAction isShowLabel={true} key={'record-action'} />,
                        ]}
                    />,
                    <LeaveAction isShowLabel={true} key={'leave-action'} />,
                ]}
                leftActions={[<MeetingInfoAction key={'meeting-info-action'} />]}
                rightActions={[<LogoIcon key={'logo-icon'} text='RingCentral' />]}
            />
        </div>
    );
}

export default {
    title: 'Example/Video Meeting',
};

export const GalleryView: Story = () => {
    return (
        <MeetingWrapper>
            <Meeting />
        </MeetingWrapper>
    );
};
`,locationsMap:{"gallery-view":{startLoc:{col:34,line:68},endLoc:{col:1,line:74},startBody:{col:34,line:68},endBody:{col:1,line:74}}}}},title:"Example/Video Meeting"},Jt=a(()=>n(Lt,{children:n(_t,{})}),"GalleryView"),Ft=["GalleryView"];export{Jt as GalleryView,Ft as __namedExportsOrder,zt as default};
//# sourceMappingURL=Gallery.stories.6652d2b2.js.map
